(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>l,r:()=>d});var a=r(5155),i=r(2115),s=r(9708),n=r(2085),o=r(9434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=i.forwardRef((e,t)=>{let{className:r,variant:i,size:n,asChild:l=!1,...c}=e,u=l?s.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(d({variant:i,size:n,className:r})),ref:t,...c})});l.displayName="Button"},286:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(157).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2067:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var a=r(5155),i=r(2115),s=r(5695),n=r(6874),o=r.n(n),d=r(6766),l=r(285),c=r(2523),u=r(5057),m=r(6695),f=r(7481),p=r(7039),h=r(3004),g=r(157);let v=(0,g.A)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var x=r(286);let y=(0,g.A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var b=r(172),w=r(5297);function j(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),{toast:r}=(0,f.dj)(),[n,g]=(0,i.useState)(""),[j,N]=(0,i.useState)(""),[k,S]=(0,i.useState)(""),[A,_]=(0,i.useState)(""),[C,E]=(0,i.useState)(!1),[M,T]=(0,i.useState)("signup"),[U,z]=(0,i.useState)(""),[D,I]=(0,i.useState)("");(0,i.useEffect)(()=>{let e=t.get("action"),r=t.get("inviteCode");r?(T("join_org"),z(r)):"create_org"===e?T("create_org"):"join_org"===e&&T("join_org")},[t]);let O=async t=>{if(t.preventDefault(),!n.trim())return void r({title:"Error",description:"Please enter your full name.",variant:"destructive"});if(k!==A)return void r({title:"Error",description:"Passwords do not match.",variant:"destructive"});if("create_org"===M&&!D.trim())return void r({title:"Error",description:"Please enter an organization name.",variant:"destructive"});if("join_org"===M&&!U.trim())return void r({title:"Error",description:"Please enter an invite code.",variant:"destructive"});E(!0);try{let t=(await (0,h.eJ)(p.j,j,k)).user;if(await (0,h.r7)(t,{displayName:n.trim()}),await (0,w.Jt)(t,n.trim()),"create_org"===M)await (0,w.EC)(t.uid,D.trim()),r({title:"Success!",description:"Account and organization created."});else if("join_org"===M){let e=await (0,w.K5)(t.uid,U.trim());if(!e)throw Error("Invalid invite code.");r({title:"Success!",description:"Account created and you've joined ".concat(e.name,".")})}else r({title:"Account Created!",description:"You can now join or create an organization."});e.push("/")}catch(e){r({title:"Signup Failed",description:e.message.includes("Invalid invite code")?"Invalid invite code. Please check and try again.":e.message||"Could not create your account.",variant:"destructive"})}finally{E(!1)}};return(0,a.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-background to-secondary/10 flex flex-col items-center justify-center p-4 sm:p-8",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)(d.default,{src:"/logo.png",alt:"KSHT Logo",width:100,height:100,className:"mx-auto rounded-full shadow-lg","data-ai-hint":"temple logo",priority:!0}),(0,a.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold mt-4",children:(0,a.jsx)("span",{className:"bg-gradient-to-r from-primary to-accent text-transparent bg-clip-text",children:"KSHT Volunteer Log"})})]}),(0,a.jsxs)(m.Zp,{className:"w-full max-w-md shadow-xl rounded-xl",children:[(0,a.jsxs)(m.aR,{className:"text-center",children:[(0,a.jsxs)(m.ZB,{className:"text-2xl sm:text-3xl font-bold flex items-center justify-center gap-2",children:["create_org"===M?(0,a.jsx)(v,{className:"h-7 w-7 text-primary"}):"join_org"===M?(0,a.jsx)(x.A,{className:"h-7 w-7 text-primary"}):(0,a.jsx)(y,{className:"h-7 w-7 text-primary"})," ","create_org"===M?"Create Organization":"join_org"===M?"Join Organization":"Create an Account"]}),(0,a.jsx)(m.BT,{children:"create_org"===M?"First, create your account, then your new organization.":"join_org"===M?"Create an account to join an organization with an invite code.":"Get started with KSHT Volunteer Log."})]}),(0,a.jsx)(m.Wu,{children:(0,a.jsxs)("form",{onSubmit:O,className:"space-y-4",children:["create_org"===M&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"orgName",children:"New Organization Name"}),(0,a.jsx)(c.p,{id:"orgName",value:D,onChange:e=>I(e.target.value),required:!0})]}),"join_org"===M&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"inviteCode",children:"Invite Code"}),(0,a.jsx)(c.p,{id:"inviteCode",value:U,onChange:e=>z(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"fullName",children:"Full Name"}),(0,a.jsx)(c.p,{id:"fullName",value:n,onChange:e=>g(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"email",children:"Email"}),(0,a.jsx)(c.p,{id:"email",type:"email",value:j,onChange:e=>N(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"password",children:"Password"}),(0,a.jsx)(c.p,{id:"password",type:"password",value:k,onChange:e=>S(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"confirm-password",children:"Confirm Password"}),(0,a.jsx)(c.p,{id:"confirm-password",type:"password",value:A,onChange:e=>_(e.target.value),required:!0})]}),(0,a.jsxs)(l.$,{type:"submit",className:"w-full",disabled:C,children:[C&&(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign Up"]})]})}),(0,a.jsx)(m.wL,{className:"text-center block",children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Already have an account?"," ",(0,a.jsx)(o(),{href:"/login",className:"font-medium text-primary hover:underline",children:"Log in"})]})})]})]})}function N(){return(0,a.jsx)(i.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(j,{})})}},2523:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var a=r(5155),i=r(2115),s=r(9434);let n=i.forwardRef((e,t)=>{let{className:r,type:i,...n}=e;return(0,a.jsx)("input",{type:i,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});n.displayName="Input"},5057:(e,t,r)=>{"use strict";r.d(t,{J:()=>l});var a=r(5155),i=r(2115),s=r(968),n=r(2085),o=r(9434);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)(s.b,{ref:t,className:(0,o.cn)(d(),r),...i})});l.displayName=s.b.displayName},5297:(e,t,r)=>{"use strict";r.d(t,{Dp:()=>u,EC:()=>o,Jt:()=>n,K5:()=>d,RH:()=>c,ci:()=>l});var a=r(7039),i=r(5317);let s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r="";for(let a=0;a<e;a++)r+=t.charAt(Math.floor(Math.random()*t.length));return r},n=async(e,t)=>{if(!a.db)throw Error("Firestore not initialized");let r=(0,i.H9)(a.db,"users",e.uid);(await (0,i.x7)(r)).exists()||await (0,i.BN)(r,{uid:e.uid,email:e.email,displayName:t,createdAt:(0,i.O5)()})},o=async(e,t)=>{var r,n;if(!a.db)throw Error("Firestore not initialized");let o=s(8),d=(0,i.H9)((0,i.rJ)(a.db,"organizations")),l={name:t.trim(),ownerUid:e,inviteCode:o,memberUids:[e]};await (0,i.BN)(d,{...l,createdAt:(0,i.O5)()});let c=(await (0,i.x7)(d)).data();return{id:d.id,name:null==c?void 0:c.name,ownerUid:null==c?void 0:c.ownerUid,inviteCode:null==c?void 0:c.inviteCode,memberUids:null==c?void 0:c.memberUids,createdAt:null!=(n=null==c||null==(r=c.createdAt)?void 0:r.toDate())?n:new Date}},d=async(e,t)=>{if(!a.db)throw Error("Firestore not initialized");let r=(0,i.rJ)(a.db,"organizations"),s=(0,i.P)(r,(0,i._M)("inviteCode","==",t.trim())),n=await (0,i.GG)(s);if(n.empty)return null;let o=n.docs[0];await (0,i.mZ)(o.ref,{memberUids:(0,i.hq)(e)});let d=o.data();return{id:o.id,name:d.name,ownerUid:d.ownerUid,inviteCode:d.inviteCode,memberUids:[...d.memberUids,e],createdAt:d.createdAt.toDate()}},l=async e=>{if(!a.db)throw Error("Firestore not initialized");let t=(0,i.rJ)(a.db,"organizations"),r=(0,i.P)(t,(0,i._M)("ownerUid","==",e)),s=(0,i.P)(t,(0,i._M)("memberUids","array-contains",e)),[n,o]=await Promise.all([(0,i.GG)(r),(0,i.GG)(s)]),d=new Map,l=e=>{e.forEach(e=>{if(!d.has(e.id)){var t,r;let a=e.data();d.set(e.id,{id:e.id,name:a.name,ownerUid:a.ownerUid,inviteCode:a.inviteCode,memberUids:a.memberUids,createdAt:null!=(r=null==(t=a.createdAt)?void 0:t.toDate())?r:new Date})}})};return l(n),l(o),Array.from(d.values())},c=async e=>{if(!a.db)throw Error("Firestore not initialized");let t=(0,i.H9)(a.db,"organizations",e),r=await (0,i.x7)(t);if(!r.exists())throw Error("Organization not found.");let s=r.data().memberUids||[];if(0===s.length)return[];let n=(0,i.rJ)(a.db,"users"),o=(0,i.P)(n,(0,i._M)("uid","in",s));return(await (0,i.GG)(o)).docs.map(e=>e.data())},u=async e=>{if(!a.db)throw Error("Firestore not initialized");let t=(0,i.H9)(a.db,"organizations",e);await (0,i.kd)(t)}},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>o,wL:()=>u});var a=r(5155),i=r(2115),s=r(9434);let n=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...i})});n.displayName="Card";let o=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...i})});o.displayName="CardHeader";let d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...i})});d.displayName="CardTitle";let l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...i})});l.displayName="CardDescription";let c=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...i})});c.displayName="CardContent";let u=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...i})});u.displayName="CardFooter"},7039:(e,t,r)=>{"use strict";let a,i,s;r.d(t,{db:()=>s,j:()=>i});var n=r(3915),o=r(3004),d=r(5317);let l={apiKey:"AIzaSyAOfD2G2l2wZcfnlMDflhNwqDLUpBQwA7o",authDomain:"ksht-log.firebaseapp.com",projectId:"ksht-log",storageBucket:"ksht-log.firebasestorage.app",messagingSenderId:"765926944390",appId:"1:765926944390:web:33e9224fa0eec820d62b07",measurementId:"G-4E9KRW3VSW"};if((0,n.Dk)().length)a=(0,n.Dk)().length>0?(0,n.Sx)():(0,n.Wp)(l),i=(0,o.xI)(a),s=(0,d.aU)(a);else try{a=(0,n.Wp)(l),i=(0,o.xI)(a),s=(0,d.aU)(a)}catch(e){console.error("Firebase initialization error",e),a=(0,n.Dk)()[0],i=(0,o.xI)(a),s=(0,d.aU)(a)}l.apiKey||console.error("Firebase config not loaded. Check your .env.local file and restart the server.")},7481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>m});var a=r(2115);let i=0,s=new Map,n=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],l={toasts:[]};function c(e){l=o(l,e),queueMicrotask(()=>{d.forEach(e=>{e(l)})})}function u(e){let{...t}=e,r=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=a.useState(l);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9304:(e,t,r)=>{Promise.resolve().then(r.bind(r,2067))},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var a=r(2596),i=r(9688);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,416,221,486,874,441,684,358],()=>t(9304)),_N_E=e.O()}]);